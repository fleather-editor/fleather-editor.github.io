<!DOCTYPE html>
<html lang="en-US">

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,maximum-scale=2">
    <link rel="stylesheet" type="text/css" media="screen" href="/assets/css/style.css?v=283500f91980d91031e083409342feab137f96f8">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Quick Start | Fleather</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="Quick Start" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="http://localhost:4000/doc/quick-start.html" />
<meta property="og:url" content="http://localhost:4000/doc/quick-start.html" />
<meta property="og:site_name" content="Fleather" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Quick Start" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","headline":"Quick Start","url":"http://localhost:4000/doc/quick-start.html"}</script>
<!-- End Jekyll SEO tag -->

    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->

  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          
            <a id="forkme_banner" href="https://github.com/fleather-editor/fleather-editor.github.io">View on GitHub</a>
          

          <h1 id="project_title">Fleather</h1>
          <h2 id="project_tagline"></h2>

          
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h2 id="quick-start">Quick Start</h2>

<p>In this tutorial you’ll create a simple Flutter app that supports rich text editing with Fleather.
What you’ll learn:</p>

<ul>
  <li>How to create a new screen for the editor</li>
  <li>Basic widget layout required by Fleather</li>
  <li>How to load and save documents using JSON serialization</li>
</ul>

<h3 id="01-create-a-new-flutter-project">01. Create a new Flutter project</h3>

<p>If you haven’t installed Flutter yet
then <a href="https://flutter.dev/docs/get-started/install">install it first</a>.</p>

<p>Create a new project using Terminal and <code class="language-plaintext highlighter-rouge">flutter create</code> command:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>flutter create myapp
<span class="nv">$ </span><span class="nb">cd </span>myapp
</code></pre></div></div>

<p>For more methods of creating a project
see <a href="https://flutter.dev/docs/get-started/test-drive">official documentation</a>.</p>

<h3 id="02-add-fleather-to-your-project">02. Add Fleather to your project</h3>

<p>Add <code class="language-plaintext highlighter-rouge">fleather</code> package as a dependency to <code class="language-plaintext highlighter-rouge">pubspec.yaml</code> of your new project:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">dependencies</span><span class="pi">:</span>
  <span class="na">fleather</span><span class="pi">:</span> <span class="pi">[</span> <span class="nv">latest_version</span> <span class="pi">]</span>
</code></pre></div></div>

<p>And run <code class="language-plaintext highlighter-rouge">flutter packages get</code>. This installs <a href="https://pub.dev/packages/fleather">fleather</a> and all
required dependencies, including <a href="https://pub.dev/packages/parchment">parchment</a> package which
implements Fleather’s document model.</p>

<blockquote>
  <p>Parchment package is platform-agnostic and can be used outside of Flutter apps
(in web or server-side Dart projects).</p>
</blockquote>

<h3 id="03-create-editor-page">03. Create editor page</h3>

<p>We start by creating a <code class="language-plaintext highlighter-rouge">StatefulWidget</code> that will be responsible for handling all the state and
interactions with Fleather. In this example we’ll assume that there is dedicated editor page in our
app.</p>

<p>Create a new file <code class="language-plaintext highlighter-rouge">lib/src/editor_page.dart</code> and type in (or paste) the following:</p>

<div class="language-dart highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="s">'package:flutter/material.dart'</span><span class="o">;</span>
<span class="kn">import</span> <span class="s">'package:quill_delta/quill_delta.dart'</span><span class="o">;</span>
<span class="kn">import</span> <span class="s">'package:fleather/fleather.dart'</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">EditorPage</span> <span class="kd">extends</span> <span class="n">StatefulWidget</span> <span class="o">{</span>
  <span class="nd">@override</span>
  <span class="n">EditorPageState</span> <span class="n">createState</span><span class="o">()</span> <span class="o">=&gt;</span> <span class="n">EditorPageState</span><span class="o">();</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">EditorPageState</span> <span class="kd">extends</span> <span class="n">State</span><span class="o">&lt;</span><span class="n">EditorPage</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="c1">/// Allows to control the editor and the document.</span>
  <span class="n">FleatherController</span> <span class="n">_controller</span><span class="o">;</span>

  <span class="c1">/// Fleather editor like any other input field requires a focus node.</span>
  <span class="n">FocusNode</span> <span class="n">_focusNode</span><span class="o">;</span>

  <span class="nd">@override</span>
  <span class="kt">void</span> <span class="n">initState</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">super</span><span class="o">.</span><span class="na">initState</span><span class="o">();</span>
    <span class="c1">// Here we must load the document and pass it to Fleather controller.</span>
    <span class="kd">final</span> <span class="n">document</span> <span class="o">=</span> <span class="n">_loadDocument</span><span class="o">();</span>
    <span class="n">_controller</span> <span class="o">=</span> <span class="n">FleatherController</span><span class="o">(</span><span class="n">document</span><span class="o">);</span>
    <span class="n">_focusNode</span> <span class="o">=</span> <span class="n">FocusNode</span><span class="o">();</span>
  <span class="o">}</span>

  <span class="nd">@override</span>
  <span class="n">Widget</span> <span class="n">build</span><span class="o">(</span><span class="n">BuildContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Note that the editor requires special `FleatherScaffold` widget to be</span>
    <span class="c1">// one of its parents.</span>
    <span class="k">return</span> <span class="n">Scaffold</span><span class="o">(</span>
      <span class="nl">appBar:</span> <span class="n">AppBar</span><span class="o">(</span><span class="nl">title:</span> <span class="n">Text</span><span class="o">(</span><span class="s">"Editor page"</span><span class="o">)),</span>
      <span class="nl">body:</span> <span class="n">FleatherScaffold</span><span class="o">(</span>
        <span class="nl">child:</span> <span class="n">FleatherEditor</span><span class="o">(</span>
          <span class="nl">padding:</span> <span class="n">EdgeInsets</span><span class="o">.</span><span class="na">all</span><span class="o">(</span><span class="mi">16</span><span class="o">),</span>
          <span class="nl">controller:</span> <span class="n">_controller</span><span class="o">,</span>
          <span class="nl">focusNode:</span> <span class="n">_focusNode</span><span class="o">,</span>
        <span class="o">),</span>
      <span class="o">),</span>
    <span class="o">);</span>
  <span class="o">}</span>

  <span class="c1">/// Loads the document to be edited in Fleather.</span>
  <span class="n">ParchmentDocument</span> <span class="n">_loadDocument</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// For simplicity we hardcode a simple document with one line of text</span>
    <span class="c1">// saying "Fleather Quick Start".</span>
    <span class="c1">// (Note that delta must always end with newline.)</span>
    <span class="kd">final</span> <span class="n">Delta</span> <span class="n">delta</span> <span class="o">=</span> <span class="n">Delta</span><span class="o">()</span>
      <span class="o">..</span><span class="na">insert</span><span class="o">(</span><span class="s">"Fleather Quick Start</span><span class="se">\n</span><span class="s">"</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">ParchmentDocument</span><span class="o">.</span><span class="na">fromDelta</span><span class="o">(</span><span class="n">delta</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Above example widget creates a page with an <code class="language-plaintext highlighter-rouge">AppBar</code> and Fleather editor in its body. We also
initialize our editor with a simple one-line document.</p>

<p>Now we need to wire it up with our app. Open <code class="language-plaintext highlighter-rouge">lib/main.dart</code> and replace autogenerated contents with
this:</p>

<div class="language-dart highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="s">'package:flutter/material.dart'</span><span class="o">;</span>

<span class="kn">import</span> <span class="s">'src/editor_page.dart'</span><span class="o">;</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">runApp</span><span class="o">(</span><span class="n">QuickStartApp</span><span class="o">());</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">QuickStartApp</span> <span class="kd">extends</span> <span class="n">StatelessWidget</span> <span class="o">{</span>
  <span class="nd">@override</span>
  <span class="n">Widget</span> <span class="n">build</span><span class="o">(</span><span class="n">BuildContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">MaterialApp</span><span class="o">(</span>
      <span class="nl">title:</span> <span class="s">'Quick Start'</span><span class="o">,</span>
      <span class="nl">home:</span> <span class="n">HomePage</span><span class="o">(),</span>
      <span class="nl">routes:</span> <span class="o">{</span>
        <span class="s">"/editor"</span><span class="o">:</span> <span class="o">(</span><span class="n">context</span><span class="o">)</span> <span class="o">=&gt;</span> <span class="n">EditorPage</span><span class="o">(),</span>
      <span class="o">},</span>
    <span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">HomePage</span> <span class="kd">extends</span> <span class="n">StatelessWidget</span> <span class="o">{</span>
  <span class="nd">@override</span>
  <span class="n">Widget</span> <span class="n">build</span><span class="o">(</span><span class="n">BuildContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">final</span> <span class="n">navigator</span> <span class="o">=</span> <span class="n">Navigator</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">Scaffold</span><span class="o">(</span>
      <span class="nl">appBar:</span> <span class="n">AppBar</span><span class="o">(</span><span class="nl">title:</span> <span class="n">Text</span><span class="o">(</span><span class="s">"Quick Start"</span><span class="o">)),</span>
      <span class="nl">body:</span> <span class="n">Center</span><span class="o">(</span>
        <span class="nl">child:</span> <span class="n">FlatButton</span><span class="o">(</span>
          <span class="nl">child:</span> <span class="n">Text</span><span class="o">(</span><span class="s">"Open editor"</span><span class="o">),</span>
          <span class="nl">onPressed:</span> <span class="o">()</span> <span class="o">=&gt;</span> <span class="n">navigator</span><span class="o">.</span><span class="na">pushNamed</span><span class="o">(</span><span class="s">"/editor"</span><span class="o">),</span>
        <span class="o">),</span>
      <span class="o">),</span>
    <span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="04-save-document-to-json-file">04. Save document to JSON file</h3>

<p>At this point we can already edit the document and apply styles, however if we navigate back from
this page our changes will be lost. Let’s fix this and add a button which saves the document to the
device’s file system.</p>

<p>First we need a function to save the document. Update <code class="language-plaintext highlighter-rouge">lib/src/editor_page.dart</code>
as follows:</p>

<div class="language-dart highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// change: add these two lines to imports section at the top of the file</span>
<span class="kn">import</span> <span class="s">'dart:convert'</span><span class="o">;</span> <span class="c1">// access to jsonEncode()</span>
<span class="kn">import</span> <span class="s">'dart:io'</span><span class="o">;</span> <span class="c1">// access to File and Directory classes</span>

<span class="kd">class</span> <span class="nc">EditorPageState</span> <span class="kd">extends</span> <span class="n">State</span><span class="o">&lt;</span><span class="n">EditorPage</span><span class="o">&gt;</span> <span class="o">{</span>

  <span class="c1">// change: add after _loadDocument()</span>

  <span class="kt">void</span> <span class="n">_saveDocument</span><span class="o">(</span><span class="n">BuildContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Parchment documents can be easily serialized to JSON by passing to</span>
    <span class="c1">// `jsonEncode` directly</span>
    <span class="kd">final</span> <span class="n">contents</span> <span class="o">=</span> <span class="n">jsonEncode</span><span class="o">(</span><span class="n">_controller</span><span class="o">.</span><span class="na">document</span><span class="o">);</span>
    <span class="c1">// For this example we save our document to a temporary file.</span>
    <span class="kd">final</span> <span class="n">file</span> <span class="o">=</span> <span class="n">File</span><span class="o">(</span><span class="n">Directory</span><span class="o">.</span><span class="na">systemTemp</span><span class="o">.</span><span class="na">path</span> <span class="o">+</span> <span class="s">"/quick_start.json"</span><span class="o">);</span>
    <span class="c1">// And show a snack bar on success.</span>
    <span class="n">file</span><span class="o">.</span><span class="na">writeAsString</span><span class="o">(</span><span class="n">contents</span><span class="o">).</span><span class="na">then</span><span class="o">((</span><span class="n">_</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">Scaffold</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">context</span><span class="o">).</span><span class="na">showSnackBar</span><span class="o">(</span><span class="n">SnackBar</span><span class="o">(</span><span class="nl">content:</span> <span class="n">Text</span><span class="o">(</span><span class="s">"Saved."</span><span class="o">)));</span>
    <span class="o">});</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>This function converts our document using <code class="language-plaintext highlighter-rouge">jsonEncode()</code> function and writes the result to a
file <code class="language-plaintext highlighter-rouge">quick_start.json</code> in the system’s temporary directory.</p>

<p>Note that <code class="language-plaintext highlighter-rouge">File.writeAsString</code> is an asynchronous method and returns Dart’s
<code class="language-plaintext highlighter-rouge">Future</code>. This is why we register a completion callback with a call to
<code class="language-plaintext highlighter-rouge">Future.then</code>.</p>

<p>One more important bit here is that we pass <code class="language-plaintext highlighter-rouge">BuildContext</code> argument to
<code class="language-plaintext highlighter-rouge">_saveDocument</code>. This is required to get access to our page’s <code class="language-plaintext highlighter-rouge">Scaffold</code> state, so that we can show
a <code class="language-plaintext highlighter-rouge">SnackBar</code>.</p>

<p>Now we just need to add a button to the AppBar, so we need to modify <code class="language-plaintext highlighter-rouge">build</code>
method as follows:</p>

<div class="language-dart highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">EditorPageState</span> <span class="kd">extends</span> <span class="n">State</span><span class="o">&lt;</span><span class="n">EditorPage</span><span class="o">&gt;</span> <span class="o">{</span>

  <span class="c1">// change: replace build() method with following</span>

  <span class="nd">@override</span>
  <span class="n">Widget</span> <span class="n">build</span><span class="o">(</span><span class="n">BuildContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Note that the editor requires special `FleatherScaffold` widget to be</span>
    <span class="c1">// present somewhere up the widget tree.</span>
    <span class="k">return</span> <span class="n">Scaffold</span><span class="o">(</span>
      <span class="nl">appBar:</span> <span class="n">AppBar</span><span class="o">(</span>
        <span class="nl">title:</span> <span class="n">Text</span><span class="o">(</span><span class="s">"Editor page"</span><span class="o">),</span>
        <span class="c1">// &lt;&lt;&lt; begin change</span>
        <span class="nl">actions:</span> <span class="o">&lt;</span><span class="n">Widget</span><span class="o">&gt;[</span>
          <span class="n">Builder</span><span class="o">(</span>
            <span class="nl">builder:</span> <span class="o">(</span><span class="n">context</span><span class="o">)</span> <span class="o">=&gt;</span>
                <span class="n">IconButton</span><span class="o">(</span>
                  <span class="nl">icon:</span> <span class="n">Icon</span><span class="o">(</span><span class="n">Icons</span><span class="o">.</span><span class="na">save</span><span class="o">),</span>
                  <span class="nl">onPressed:</span> <span class="o">()</span> <span class="o">=&gt;</span> <span class="n">_saveDocument</span><span class="o">(</span><span class="n">context</span><span class="o">),</span>
                <span class="o">),</span>
          <span class="o">)</span>
        <span class="o">],</span>
        <span class="c1">// end change &gt;&gt;&gt;</span>
      <span class="o">),</span>
      <span class="nl">body:</span> <span class="n">FleatherScaffold</span><span class="o">(</span>
        <span class="nl">child:</span> <span class="n">FleatherEditor</span><span class="o">(</span>
          <span class="nl">padding:</span> <span class="n">EdgeInsets</span><span class="o">.</span><span class="na">all</span><span class="o">(</span><span class="mi">16</span><span class="o">),</span>
          <span class="nl">controller:</span> <span class="n">_controller</span><span class="o">,</span>
          <span class="nl">focusNode:</span> <span class="n">_focusNode</span><span class="o">,</span>
        <span class="o">),</span>
      <span class="o">),</span>
    <span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>We have to use <code class="language-plaintext highlighter-rouge">Builder</code> here for our icon button because we need <code class="language-plaintext highlighter-rouge">BuildContext</code>
which has access to <code class="language-plaintext highlighter-rouge">Scaffold</code> widget’s state.</p>

<p>Now we can reload our app, hit “Save” button and see the snack bar.</p>

<h3 id="05-load-document-from-json-file">05. Load document from JSON file</h3>

<p>Since we now have this document saved to a file, let’s update our
<code class="language-plaintext highlighter-rouge">_loadDocument</code> method to load saved file if it exists.</p>

<div class="language-dart highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">EditorPageState</span> <span class="kd">extends</span> <span class="n">State</span><span class="o">&lt;</span><span class="n">EditorPage</span><span class="o">&gt;</span> <span class="o">{</span>

  <span class="c1">// change: replace _loadDocument() method with following</span>

  <span class="c1">/// Loads the document asynchronously from a file if it exists, otherwise</span>
  <span class="c1">/// returns default document.</span>
  <span class="n">Future</span><span class="o">&lt;</span><span class="n">ParchmentDocument</span><span class="o">&gt;</span> <span class="n">_loadDocument</span><span class="o">()</span> <span class="n">async</span> <span class="o">{</span>
    <span class="kd">final</span> <span class="n">file</span> <span class="o">=</span> <span class="n">File</span><span class="o">(</span><span class="n">Directory</span><span class="o">.</span><span class="na">systemTemp</span><span class="o">.</span><span class="na">path</span> <span class="o">+</span> <span class="s">"/quick_start.json"</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">await</span> <span class="n">file</span><span class="o">.</span><span class="na">exists</span><span class="o">())</span> <span class="o">{</span>
      <span class="kd">final</span> <span class="n">contents</span> <span class="o">=</span> <span class="n">await</span> <span class="n">file</span><span class="o">.</span><span class="na">readAsString</span><span class="o">();</span>
      <span class="k">return</span> <span class="n">ParchmentDocument</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">jsonDecode</span><span class="o">(</span><span class="n">contents</span><span class="o">));</span>
    <span class="o">}</span>
    <span class="kd">final</span> <span class="n">Delta</span> <span class="n">delta</span> <span class="o">=</span> <span class="n">Delta</span><span class="o">()</span>
      <span class="o">..</span><span class="na">insert</span><span class="o">(</span><span class="s">"Fleather Quick Start</span><span class="se">\n</span><span class="s">"</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">ParchmentDocument</span><span class="o">.</span><span class="na">fromDelta</span><span class="o">(</span><span class="n">delta</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>We had to convert this method to be <strong>async</strong> because file system operations are asynchronous. This
breaks our <code class="language-plaintext highlighter-rouge">initState</code> logic so we need to fix it next. However we can no longer
initialize <code class="language-plaintext highlighter-rouge">FleatherController</code> in <code class="language-plaintext highlighter-rouge">initState</code> and therefore can’t display the editor until document
is loaded.</p>

<p>One way to fix this is to show loader animation while we are reading our document from file. But
first, we still need to update <code class="language-plaintext highlighter-rouge">initState</code> method:</p>

<div class="language-dart highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">EditorPageState</span> <span class="kd">extends</span> <span class="n">State</span><span class="o">&lt;</span><span class="n">EditorPage</span><span class="o">&gt;</span> <span class="o">{</span>

  <span class="c1">// change: replace initState() method with following</span>

  <span class="nd">@override</span>
  <span class="kt">void</span> <span class="n">initState</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">super</span><span class="o">.</span><span class="na">initState</span><span class="o">();</span>
    <span class="n">_focusNode</span> <span class="o">=</span> <span class="n">FocusNode</span><span class="o">();</span>
    <span class="n">_loadDocument</span><span class="o">().</span><span class="na">then</span><span class="o">((</span><span class="n">document</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">setState</span><span class="o">(()</span> <span class="o">{</span>
        <span class="n">_controller</span> <span class="o">=</span> <span class="n">FleatherController</span><span class="o">(</span><span class="n">document</span><span class="o">);</span>
      <span class="o">});</span>
    <span class="o">});</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>We initialize <code class="language-plaintext highlighter-rouge">_controller</code> only when our document is fully loaded from the file system. An
important part here is to update <code class="language-plaintext highlighter-rouge">_controller</code> field inside of
<code class="language-plaintext highlighter-rouge">setState</code> call as required by Flutter’s <code class="language-plaintext highlighter-rouge">StatefulWidget</code>’s contract.</p>

<p>The only thing left is to update <code class="language-plaintext highlighter-rouge">build()</code> method to show loader animation:</p>

<div class="language-dart highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">EditorPageState</span> <span class="kd">extends</span> <span class="n">State</span><span class="o">&lt;</span><span class="n">EditorPage</span><span class="o">&gt;</span> <span class="o">{</span>

  <span class="c1">// change: replace build() method with following</span>

  <span class="nd">@override</span>
  <span class="n">Widget</span> <span class="n">build</span><span class="o">(</span><span class="n">BuildContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// If _controller is null we show Material Design loader, otherwise</span>
    <span class="c1">// display Fleather editor.</span>
    <span class="kd">final</span> <span class="n">Widget</span> <span class="n">body</span> <span class="o">=</span> <span class="o">(</span><span class="n">_controller</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
        <span class="o">?</span> <span class="n">Center</span><span class="o">(</span><span class="nl">child:</span> <span class="n">CircularProgressIndicator</span><span class="o">())</span>
        <span class="o">:</span> <span class="n">FleatherrScaffold</span><span class="o">(</span>
      <span class="nl">child:</span> <span class="n">FleatherEditor</span><span class="o">(</span>
        <span class="nl">padding:</span> <span class="n">EdgeInsets</span><span class="o">.</span><span class="na">all</span><span class="o">(</span><span class="mi">16</span><span class="o">),</span>
        <span class="nl">controller:</span> <span class="n">_controller</span><span class="o">,</span>
        <span class="nl">focusNode:</span> <span class="n">_focusNode</span><span class="o">,</span>
      <span class="o">),</span>
    <span class="o">);</span>

    <span class="k">return</span> <span class="n">Scaffold</span><span class="o">(</span>
      <span class="nl">appBar:</span> <span class="n">AppBar</span><span class="o">(</span>
        <span class="nl">title:</span> <span class="n">Text</span><span class="o">(</span><span class="s">"Editor page"</span><span class="o">),</span>
        <span class="nl">actions:</span> <span class="o">&lt;</span><span class="n">Widget</span><span class="o">&gt;[</span>
          <span class="n">Builder</span><span class="o">(</span>
            <span class="nl">builder:</span> <span class="o">(</span><span class="n">context</span><span class="o">)</span> <span class="o">=&gt;</span>
                <span class="n">IconButton</span><span class="o">(</span>
                  <span class="nl">icon:</span> <span class="n">Icon</span><span class="o">(</span><span class="n">Icons</span><span class="o">.</span><span class="na">save</span><span class="o">),</span>
                  <span class="nl">onPressed:</span> <span class="o">()</span> <span class="o">=&gt;</span> <span class="n">_saveDocument</span><span class="o">(</span><span class="n">context</span><span class="o">),</span>
                <span class="o">),</span>
          <span class="o">)</span>
        <span class="o">],</span>
      <span class="o">),</span>
      <span class="nl">body:</span> <span class="n">body</span><span class="o">,</span>
    <span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>If we save changes now and reload the app we should see something like this.</p>

<p>Note that in your tests you’ll likely not notice any loading animation at all. This is because
reading a tiny file from disk is too fast. For the above recording we added an artificial delay of 1
second in order to demonstrate loading. If you’d like to replicate this, we’ll leave implementation
of this task to you as an exercise.</p>

      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        
        <p class="copyright">Fleather maintained by <a href="https://github.com/fleather-editor">fleather-editor</a></p>
        
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>
  </body>
</html>
